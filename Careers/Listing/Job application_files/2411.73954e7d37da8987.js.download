"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2411],{15240:function(e,t,n){n.d(t,{Z:function(){return h}});var i=n(81862),r=n(26969),o=n(44822),a=n(50853),l=n(52322),c=n(43816),u=n(2784),p=n(74767),s=n(35505),d=s.ZP.div.withConfig({componentId:"sc-a737b3be-0"})(["display:flex;flex-direction:column;box-shadow:",";border-radius:5px;overflow:hidden;"," "," img{display:block;max-width:100%;object-fit:cover;}svg{margin:"," 0;}"],function(e){return e.theme.color.inputBoxShadow},function(e){var t=e.width;return t&&"\n    width: ".concat(t,"px;\n  ")},function(e){var t=e.height;return t&&"\n    height: ".concat(t,"px;\n  ")},function(e){return e.theme.spacing.lg}),f=s.ZP.div.withConfig({componentId:"sc-a737b3be-1"})(["display:flex;align-items:center;justify-content:center;height:","px;overflow:hidden;font-size:12px;> div:first-child{width:100%;padding:0 ",";line-height:28px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}"],function(e){return e.height},function(e){return e.theme.spacing.xs}),m=s.ZP.div.withConfig({componentId:"sc-a737b3be-2"})(["display:flex;justify-content:space-between;border-top:1px solid ",";padding:4px;font-size:10px;font-weight:500;> div:first-child{width:100%;padding:0 4px;line-height:20px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}button{margin-left:4px;}"],function(e){return e.theme.color.border});s.ZP.div.withConfig({componentId:"sc-a737b3be-3"})(["display:grid;place-items:center center;min-width:24px;width:24px;height:24px;cursor:pointer;svg{color:",";margin:0;}@media (hover:hover){:hover{background-color:",";border-radius:3px;}}"],function(e){return e.theme.color.textGrayscale4},function(e){return e.theme.color.actionBackgroundHover});var h=function(e){var t=e.file,n=e.width,s=void 0===n?200:n,h=e.height,v=void 0===h?200:h,g=e.compact,x=e.showImage,y=e.actions,b=(0,r._)((0,u.useState)(-1),2),w=b[0],j=b[1],Z=t.url&&-1!==t.mimeType.indexOf("image");if(0===y.length)return null;var z=function(){return(0,l.jsxs)(m,{children:[(0,l.jsx)("div",{title:t.name,children:t.name}),(0,o._)(y).reverse().map(function(e,t){var n,r=e.icon,o=e.tooltip,c=e.onClick,u=e.onClickAsync;return(0,l.jsx)(p.Z,{icon:r,variant:"ghost",size:"small",tooltip:o,isLoading:w===t,onClick:(n=(0,i._)(function(e){return(0,a.Jh)(this,function(n){switch(n.label){case 0:if(e.stopPropagation(),c&&c(),!u)return[3,2];return j(t),[4,u()];case 1:n.sent(),j(-1),n.label=2;case 2:return[2]}})}),function(e){return n.apply(this,arguments)})},t)})]})};return void 0!==g&&g?(0,l.jsxs)(d,{width:s,children:[Z&&(void 0===x||x)&&(0,l.jsx)(f,{height:v,children:(0,l.jsx)("img",{src:t.url,alt:t.name,height:v})}),z()]}):(0,l.jsxs)(d,{width:s,children:[(0,l.jsx)(f,{height:v,children:Z?(0,l.jsx)("img",{src:t.url,alt:t.name,height:v}):(0,l.jsx)(c.Z,{size:v/3})}),z()]})}},72411:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var i=n(81862),r=n(85333),o=n(6692),a=n(26969),l=n(44822),c=n(50853),u=n(52322),p=n(11772),s=n(48190),d=n(2784),f=n(34863),m=n(52829),h=n(75718),v=n(74767),g=n(15240),x=n(68634),y=n(64278),b=n(49026),w=n(33654),j=n(19308),Z=n(35505),z=n(44252),_=Z.ZP.div.withConfig({componentId:"sc-6663af1f-0"})(["position:relative;padding-bottom:",";"],function(e){return e.theme.spacing.sm}),k=Z.ZP.div.withConfig({componentId:"sc-6663af1f-1"})(["position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:",";cursor:pointer;border:1px dashed ",";border-radius:5px;@media (hover:hover){&:hover{box-shadow:",";}}&:focus-within{box-shadow:",";}> svg{color:",";margin-bottom:",";}> input{display:block !important;opacity:0;height:0;max-width:100%;}"],function(e){return e.theme.spacing.md},function(e){return e.theme.color.textGrayscale4},function(e){return e.theme.color.inputBoxShadowHover},function(e){return e.theme.color.inputBoxShadowFocus},function(e){return e.theme.color.textGrayscale3},function(e){return e.theme.spacing.md}),E=Z.ZP.div.withConfig({componentId:"sc-6663af1f-2"})(["display:flex;flex-wrap:wrap;> div{margin:",";}"],function(e){return e.theme.spacing.xs}),R=Z.ZP.div.withConfig({componentId:"sc-6663af1f-3"})(["display:flex;justify-content:center;align-items:center;text-align:center;color:",";"," & span{",";}"],function(e){return e.theme.color.textGrayscale2},function(e){var t=e.margin,n=e.theme;return t&&"margin-top: ".concat(n.spacing.md,";")},function(e){var t=e.theme;return(0,z.vA)("margin-left",t.spacing.sm,t.direction)}),S=Z.ZP.div.withConfig({componentId:"sc-6663af1f-4"})(["margin-top:",";svg{margin-bottom:0;}"],function(e){return e.theme.spacing.md}),T=Z.ZP.div.withConfig({componentId:"sc-6663af1f-5"})(["",";font-size:11px;color:",";line-height:1.5;text-align:center;a{color:",";@media (hover:hover){&:hover{color:",";}}}"],function(e){var t=e.hasMargin,n=e.theme;return"margin-top: ".concat(t?n.spacing.md:n.spacing.sm,";")},function(e){return e.theme.color.textGrayscale3},function(e){return e.theme.color.textGrayscale3},function(e){return e.theme.color.textGrayscale2}),U=function(e){var t,n,Z=e.mode,z=e.hasActiveSubscription,U=e.files,C=void 0===U?[]:U,I=e.isRequired,M=e.error,P=e.question,F=e.hasMinFiles,O=e.hasMaxFiles,G=e.minFiles,L=e.maxFiles,N=e.hasMultipleFiles,B=e.hasMaxFileSize,A=e.maxFileSize,J=e.maxFileSizeUnit,K=e.allowedFiles,q=e.formId,H=e.onChange,D=e.renderRequiredIndicator,V=e.respondentUuid,W=e.sessionUuid,$=(0,m.$)().t,Q=(0,a._)((0,d.useState)(!1),2),X=Q[0],Y=Q[1],ee=(0,a._)((0,d.useState)(0),2),et=ee[0],en=ee[1],ei=(0,a._)((0,d.useState)(null),2),er=ei[0],eo=ei[1],ea=(0,a._)((0,d.useState)([]),2),el=ea[0],ec=ea[1],eu=N||F&&!!G&&G>=1||O&&!!L&&L>1,ep=M?"error_".concat(null==P?void 0:P.blockGroupUuid):void 0,es=C.filter(function(e){return!e.isUploading}),ed=(0,j.SL)(null!=B&&B,A,J,z),ef=(0,j.EM)(null!=B&&B,A,J,z),em=ed&&ef?(0,j.JF)(ed,ef):void 0,eh=!!K,ev=function(e){var t=(0,l._)(C);t.splice(e,1),ec(t)},eg=(t=(0,i._)(function(e,t,n){var i,r,o,a,u,p,s,d,f,m,h,v,g,x,y,j,z,_,k,E,R,S,T,U,I,M;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(null==n||n.stopPropagation(),(null==t?void 0:t.length)>0){i=!0,r=!1,o=void 0;try{for(a=t[Symbol.iterator]();!(i=(u=a.next()).done);i=!0)p=u.value,(null===(s=p.errors[0])||void 0===s?void 0:s.code)==="file-too-large"&&eo($("form-builder.file-upload.file-too-large-error",{size:ed,unit:$("form-builder.file-upload.".concat(ef))}))}catch(e){r=!0,o=e}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return[2]}if("preview"===Z&&ec((0,l._)(C).concat((0,l._)(e.map(function(e){return{name:e.name,url:URL.createObjectURL(e),mimeType:e.type,size:e.size}})))),!("respond"===Z&&q))return[3,11];d=[],c.label=1;case 1:c.trys.push([1,10,,11]),eo(null),Y(!0),f=[],m=!0,h=!1,v=void 0;try{for(g=e[Symbol.iterator]();!(m=(x=g.next()).done);m=!0)y=x.value,f.push({name:y.name,url:URL.createObjectURL(y),mimeType:y.type,size:y.size,isUploading:!0})}catch(e){h=!0,v=e}finally{try{m||null==g.return||g.return()}finally{if(h)throw v}}eu?ec((0,l._)(C).concat((0,l._)(f))):ec((0,l._)(f)),j=0,z=!0,_=!1,k=void 0,c.label=2;case 2:c.trys.push([2,7,8,9]),E=e[Symbol.iterator](),c.label=3;case 3:if(z=(R=E.next()).done)return[3,6];return S=R.value,[4,(0,w.c)("/upload/".concat(q,"/response-asset"),S,V,W,function(t){en(Math.round(100/e.length*j+t/e.length))})];case 4:T=c.sent(),d.push(T),j++,c.label=5;case 5:return z=!0,[3,3];case 6:return[3,9];case 7:return U=c.sent(),_=!0,k=U,[3,9];case 8:try{z||null==E.return||E.return()}finally{if(_)throw k}return[7];case 9:return eu?ec((0,l._)(C).concat((0,l._)(d))):ec((0,l._)(d)),Y(!1),en(0),[3,11];case 10:return I=c.sent(),M="GENERAL",(null==I?void 0:I.message)==="Network Error"&&(M="NETWORK_ERROR"),"NETWORK_ERROR"!==M&&((0,b.Tb)(I),(0,b.uT)("File upload error",{extra:{formId:q,numOfFiles:e.length,numOfFilesUploaded:d.length,filesData:JSON.stringify(e.map(function(e){return{name:e.name,size:e.size,type:e.type}})),message:null==I?void 0:I.message}})),eo(M),Y(!1),en(0),ec(function(e){return e.filter(function(e){return!e.isUploading})}),[3,11];case 11:return[2]}})}),function(e,n,i){return t.apply(this,arguments)}),ex=(0,f.uI)({onDrop:eg,useFsAccessApi:!1,noKeyboard:!0,multiple:eu,maxSize:em,accept:eh?(0,j.hm)(K):void 0}),ey=ex.getRootProps,eb=ex.getInputProps,ew=(0,d.useRef)(!0);return(0,d.useEffect)(function(){if(ew.current){ew.current=!1;return}H&&H(el)},[el]),(0,u.jsxs)(_,{children:[(0,u.jsxs)(k,(0,o._)((0,r._)({},ey()),{children:[(0,u.jsx)("input",(0,o._)((0,r._)({},eb()),{tabIndex:0,"aria-label":null!==(n=null==P?void 0:P.title)&&void 0!==n?n:void 0,"aria-required":I?"true":"false","aria-invalid":M?"true":"false","aria-describedby":ep})),er&&(0,u.jsx)(x.Z,{errorText:er}),X&&0===es.length&&(0,u.jsxs)(R,{children:[(0,u.jsx)(h.Z,{}),(0,u.jsxs)("span",{children:[$("label.uploading")," ",et,"%"]})]}),!X&&0===es.length&&(0,u.jsxs)(d.Fragment,{children:[(0,u.jsx)(v.Z,{icon:p.Z,value:$("form-builder.file-upload.title"),variant:"ghost"}),eh&&(0,u.jsx)(T,{hasMargin:!0,children:(0,j.wA)(K,$)}),ed&&(0,u.jsx)(T,{hasMargin:!eh,children:$("form-builder.file-upload.description",{size:ed,unit:$("form-builder.file-upload.".concat(ef))})})]}),es.length>0&&(0,u.jsx)(E,{children:es.map(function(e,t){return(0,u.jsx)(g.Z,{file:e,actions:[{icon:s.Z,tooltip:$("label.delete"),onClick:function(){return ev(t)}}]},e.url)})}),eu&&X&&es.length>0&&(0,u.jsxs)(R,{margin:!0,children:[(0,u.jsx)(h.Z,{}),(0,u.jsxs)("span",{children:[$("label.uploading")," ",et,"%"]})]}),!X&&eu&&es.length>0&&(0,u.jsx)(S,{children:(0,u.jsx)(v.Z,{icon:p.Z,value:$("form-builder.file-upload.add-multiple"),variant:"ghost",isLoading:X,disabled:X})}),D&&D()]})),M&&(0,u.jsx)(y.Z,{id:ep,error:M})]})}},68634:function(e,t,n){n.d(t,{Z:function(){return a}});var i=n(52322),r=n(52829),o=n(35505).ZP.div.withConfig({componentId:"sc-9a754ac4-0"})(["color:",";font-weight:bold;padding:",";border:2px solid ",";border-radius:5px;background-color:rgba(217,57,0,0.08);margin-bottom:",";line-height:20px;"],function(e){return e.theme.color.error},function(e){return e.theme.spacing.sm},function(e){return e.theme.color.error},function(e){return e.theme.spacing.md}),a=function(e){var t=e.errorType,n=e.errorText,a=e.exception,l=(0,r.$)().t,c="";if(a){var u,p=a.response;(null==p?void 0:null===(u=p.data)||void 0===u?void 0:u.errorType)?t=p.data.errorType:a&&"Network Error"===a.message||(null==p?void 0:p.status)===0?t="NETWORK_ERROR":!p&&a&&a.message?c=a.message:t="GENERAL"}return t&&(c=l("error.".concat(t)))==="error.".concat(t)&&(c=l("error.GENERAL")),n&&(c=n),(0,i.jsx)(o,{role:"alert",children:c})}},33654:function(e,t,n){n.d(t,{c:function(){return c}});var i,r=n(81862),o=n(50853),a=n(60418),l=n(9505),c=(i=(0,r._)(function(e,t,n,i,r){var c,u,p,s,d;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(c=r?function(e){var t=(null==e?void 0:e.total)?Math.round(100*e.loaded/e.total):0;t<0&&(t=0),t>100&&(t=100),r(t)}:void 0,!(t.size<33554432))return[3,2];return u=new FormData,n&&u.append("respondentUuid",n),i&&u.append("submissionUuid",i),u.append("asset",t),[4,l.ZP.post(e,u,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:c})];case 1:case 5:return[2,o.sent().data];case 2:return[4,l.ZP.get("".concat(e,"/signed-url"),{params:{fileType:t.type,fileName:t.name,fileSize:t.size}})];case 3:return s=(p=o.sent().data).signedUploadUrl,d=p.fileId,[4,a.Z.put(s,t,{headers:{"Content-Type":t.type},onUploadProgress:c})];case 4:return o.sent(),[4,l.ZP.post("".concat(e,"/signed-url"),{fileId:d,fileType:t.type,fileName:t.name,fileSize:t.size,respondentUuid:n,submissionUuid:i})]}})}),function(e,t,n,r,o){return i.apply(this,arguments)})},19308:function(e,t,n){n.d(t,{EM:function(){return g},JF:function(){return s},SL:function(){return v},Tb:function(){return m},Uc:function(){return u},gQ:function(){return c},hm:function(){return f},nm:function(){return p},pT:function(){return d},wA:function(){return h}});var i=n(26969),r=n(44822),o=n(42145),a={image:[{type:".jpg"},{type:".jpeg"},{type:".png"},{type:".gif"},{type:".svg"},{type:".heic"},{type:".webp"},{type:".bmp"},{type:".psd"}],application:[{type:".pdf"},{type:".doc"},{type:".docx"},{type:".xls"},{type:".xlsx"},{type:".ppt"},{type:".pptx"},{type:".zip"},{type:".rar"},{type:".json"},{type:".gzip"},{type:".odt"}],text:[{type:".txt"},{type:".csv",otherMimeTypes:["application"]},{type:".html"},{type:".xml"}],video:[{type:".mp4"},{type:".mov"},{type:".webm"}],audio:[{type:".mp3"},{type:".wav"},{type:".mp4"},{type:".m4a"}]},l={".jpg":["image/jpeg"],".jpeg":["image/jpeg"],".png":["image/png"],".gif":["image/gif"],".svg":["image/svg+xml"],".heic":["image/heic","image/heif"],".webp":["image/webp"],".bmp":["image/bmp"],".psd":["image/vnd.adobe.photoshop","application/octet-stream","application/psd"],".pdf":["application/pdf"],".doc":["application/msword"],".docx":["application/vnd.openxmlformats-officedocument.wordprocessingml.document"],".xls":["application/vnd.ms-excel","application/excel","application/x-excel","application/x-msexcel"],".xlsx":["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],".ppt":["application/vnd.ms-powerpoint","application/powerpoint","application/mspowerpoint","application/vnd-mspowerpoint"],".pptx":["application/vnd.openxmlformats-officedocument.presentationml.presentation"],".zip":["application/zip","application/x-zip-compressed"],".rar":["application/vnd.rar","application/x-rar-compressed"],".json":["application/json"],".gzip":["application/gzip","application/x-gzip"],".odt":["application/vnd.oasis.opendocument.text"],".txt":["text/plain"],".csv":["text/csv","application/csv"],".html":["text/html"],".xml":["application/xml","text/xml"],".mp4":["video/mp4"],".mov":["video/quicktime"],".webm":["video/webm"],".mp3":["audio/mpeg","audio/mp3"],".wav":["audio/wav"],".m4a":["audio/mp4","audio/x-m4a","audio/m4a"]},c=function(e){return[{label:e("label.image"),options:[{text:e("label.all-image-files"),value:"image/*"}].concat((0,r._)(a.image.map(function(e){var t=e.type;return{text:t,value:t}})))},{label:e("label.video"),options:[{text:e("label.all-video-files"),value:"video/*"}].concat((0,r._)(a.video.map(function(e){var t=e.type;return{text:t,value:t}})))},{label:e("label.audio"),options:[{text:e("label.all-audio-files"),value:"audio/*"}].concat((0,r._)(a.audio.map(function(e){var t=e.type;return{text:t,value:t}})))},{label:e("label.text"),options:a.text.map(function(e){var t=e.type;return{text:t,value:t}})},{label:e("label.application"),options:a.application.map(function(e){var t=e.type;return{text:t,value:t}})}]},u=function(e){if(!e)return[];var t=[];return Object.keys(e).forEach(function(n){var i=e[n];if(i.includes("*")&&1===i.length)return t.push("".concat(n));i.filter(function(e){return"*"!==e}).forEach(function(e){t.includes(e)||t.push(e)})}),t},p=function(e){var t={};return e.forEach(function(n,r){var o=Object.keys(a).filter(function(e){return a[e].map(function(e){return e.type}).includes(n)});if(n.includes("*")){var l=(0,i._)(n.split("/"),1)[0],c="".concat(l,"/*"),u=a[l].map(function(e){return e.type}),p=e.filter(function(e){return u.includes(e)});if(0===p.length){t[c]=["*"];return}var s=0;e.forEach(function(e,t){p.includes(e)&&t>s&&(s=t)}),r>s&&(t[c]=["*"]);return}o.forEach(function(e){var i,r="".concat(e,"/*");if(!(t[r]&&t[r].includes("*"))){var o=null===(i=a[e].find(function(e){return e.type===n}))||void 0===i?void 0:i.otherMimeTypes;o&&o.forEach(function(e){var i="".concat(e,"/*");t[i]?t[i].push(n):t[i]=[n]}),t[r]?t[r].push(n):t[r]=[n]}})}),t},s=function(e,t){if(!e||!t)return 0;var n=e;return"KB"===t?n*=1024:"MB"===t?n*=1048576:"GB"===t&&(n*=1073741824),n},d=function(e,t){if(!e||!t)return 0;var n=e;return"KB"===t?n/=1024:"MB"===t?n=n/1024/1024:"GB"===t&&(n=n/1024/1024/1024),n},f=function(e){var t={},n=!0,i=!1,r=void 0;try{for(var o,a=Object.keys(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value;if(e[c].includes("*")){t[c]=[];continue}var u=!0,p=!1,s=void 0;try{for(var d,f=e[c][Symbol.iterator]();!(u=(d=f.next()).done);u=!0)!function(){var e,n=d.value;null===(e=l[n])||void 0===e||e.forEach(function(e){t[e]?t[e].push(n):t[e]=[n]})}()}catch(e){p=!0,s=e}finally{try{u||null==f.return||f.return()}finally{if(p)throw s}}}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return t},m=s(o.Z.get("file-upload.max-file-size"),o.Z.get("file-upload.max-file-size-unit")),h=function(e,t){if(void 0===e||0===Object.keys(e).length)return"";var n=[];Object.keys(e).forEach(function(i){var o=e[i],a=i.replace("/*","").trim();if(o.includes("*")&&1===o.length)return n.push(t("label.".concat(a)).toLowerCase());n.push.apply(n,(0,r._)(o))});var i=n.filter(function(e,t){return n.indexOf(e)===t});return 1===i.length?t("form-builder.file-upload.accepted-file-types",{types:i[0]}):t("form-builder.file-upload.accepted-file-types",{types:i.join(", ")})},v=function(e,t,n,i){var r=o.Z.get("file-upload.max-file-size"),a=o.Z.get("file-upload.max-file-size-unit");return e&&t?i?t:s(t,null!=n?n:a)>m?r:t:i?void 0:r},g=function(e,t,n,i){var r=o.Z.get("file-upload.max-file-size-unit");return e&&n&&t?i?n:"GB"===n?r:n:i?void 0:r}},43816:function(e,t,n){n.d(t,{Z:function(){return i}});var i=(0,n(52186).Z)("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]])},48190:function(e,t,n){n.d(t,{Z:function(){return i}});var i=(0,n(52186).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},11772:function(e,t,n){n.d(t,{Z:function(){return i}});var i=(0,n(52186).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}}]);